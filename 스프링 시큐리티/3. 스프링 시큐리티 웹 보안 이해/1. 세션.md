## [json]

- 정의: Json Web Token

## [Session]

![image](https://user-images.githubusercontent.com/108928206/197701335-ef9f2c6f-2e52-4f25-9468-b1ff022cdd16.png)

- 서버에서 헤더에 **쿠키**에 세션 id를 담아서 준다.
- 그럼 클라이언트 쿠기영역에 세션id가 있다.
- 그러고 그 다음부터는 클라이언트는 서버로 요청할 때 세션 id를 계속 준다.
- 서버에서는 세션id가 키고 그 브라우저에 대한 정보를 value로 가지고 있다. 그걸로 클라이언트를 검증한다.

## [session 종료]

- 서버에서 session을 삭제하거나
- 클라이언트가 브라우저 창을 닫을 때 사라진다.

    - 하지만 서버에는 세션id와 값이 있다.
    - 그래도 브라우저를 닫으면 클라이언트에 세션은 사라지고 그럼 서버는 다시 새로운 세션을 준다.

- 서버도 특정시간이 지나면 세션을 삭제한다. 보통 30분이다.

## [세션과 인증]

![image](https://user-images.githubusercontent.com/108928206/197702086-fc578cd7-7d33-4182-b07f-4958f66899b5.png)

- 세션은 처음 브라우저를 키면 생긴다.
- 그러고 나서 클라이언트가 받은 세션 id로 서버에 로그인 요청을 하면 
- 서버는 검증을 한 후 통과하면
- 서버는 세션영역안에 로그인 정보(유저 정보)를 담는다.
- 그러고 클라이언트가 다시 인증이 필요한 요청을 한다면 
  - 세션이 있는 지를 확인하고
  - 그 세션id안에 value에 user정보가 있다면 로그인 한 사람이라고 확인한다.

## [세션의 단점]

- 동시접속자 수가 많다면 각각의 세션을 만들어서 메모리에 띄운다.

## [해결방안]

1. (로드벨런싱 방법)

![image](https://user-images.githubusercontent.com/108928206/197703285-e963425b-8dd7-4927-83f8-dc76d0ff4a74.png)

서버를 많이 만든다.

### (로드 벨런싱의 단점)

![image](https://user-images.githubusercontent.com/108928206/197703656-b53b11b7-2d14-44bc-bb3f-38284cf5a0c5.png)

2번 서버에서 세션이 만들어졌고 그 세션안에 user정보가 있는데 다른 서버로 요청을 하면 그 서버에서는 그 사람인 줄 모른다.

  ### (로드 벨런싱의 단점의 해결방안)
    
    - 각각의 서버에 세션이 생기면 복제를 해서 다른 서버에도 가지고 있게 한다.
    - 아니면 한 사람은 하나의 서버에만 들어오게 한다.
    
  ### (로드 벨런싱의 단점의 해결방안2)
  
  ![image](https://user-images.githubusercontent.com/108928206/197704301-eb718e81-5bc0-4b28-a3a7-2e4dff49349d.png)
  
  - DB는 하나니까 DB에 세션 값을 넣고 공유해서 사용한다.
  - 단점 : 원래 서버는 메모리에 세션이 있어서 빠르지만 DB에 세션 값을 넣는다면 엄청 느려진다.
    - 왜나면 RAM은 빠르고 하드디스크는 느린데 DB는 하드디스크이다.
    - 메모리는 I/O가 일어난다. 하지만 메모리에서 찾으면 I/O가 일어나지 않는다.
    - (CPU와 RAM과 디스크)
      
      ![image](https://user-images.githubusercontent.com/108928206/197705404-a292c4b5-944a-42b9-9efa-d5be3bd65f69.png)
      - CPU에서 딸기를 요청하면 렘을 뒤지고 없으면 하드디스크에 찾고 하드디스크는 렘에 딸기를 주고 렘이 CPU에게 딸기를 준다.
      - 그래서 다음번에는 딸기를 DB에서 안찾고 렘에서 찾으면 된다. 렘에서 찾으면 I/O가 일어나지 않아서 빠르다.
      - 렘에 값을 가지고 있다=케싱
      - I/O라는 것은 DB를 뒤져서 준다는 건데 DB에서 찾는것이 펄스켄인데 그게 엄청 느리다.

  ### (로드 벨런싱의 단점의 해결방안3)
  
  ![image](https://user-images.githubusercontent.com/108928206/197706423-8bfbbc60-1b0f-495c-a762-62e364fea0fc.png)
  
  DB가 아니라 메모리서버를 둔다. EX) 레디스
  
  












