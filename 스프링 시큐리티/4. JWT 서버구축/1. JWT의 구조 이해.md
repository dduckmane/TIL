## [JSON 웹 토큰이란]

### (개념)

    - JWT(JSON 웹 토큰)는 JSON 개체로 당사자 간에 정보를 안전하게 전송하기 위한 작고 독립적인 방법을 정의하는 개방형 표준(RFC 7519)입니다.
    - 이 정보는 디지털 서명되어 있으므로 확인하고 신뢰할 수 있습니다. 
    - JWT는 비밀(HMAC 알고리즘 사용) 또는 RSA 또는 ECDSA를 사용하여 공개/개인 키 쌍을 사용하여 서명할 수 있습니다.
    - JWT는 당사자 간의 기밀성을 제공하기 위해 암호화 될 수 있지만 서명 된 토큰에 중점을 둘 것입니다. 
    - 서명된 토큰은 그 안에 포함된 정보와 무결성을 확인할 수 있으며, 암호화된 토큰은 다른 당사자로부터 해당 정보를 숨깁니다. 
    - 토큰이 공개/개인 키 쌍을 사용하여 서명되는 경우 서명은 개인 키를 보유한 당사자만 서명한 당사자임을 인증합니다.

### (필기)

    - JWT는 서명된 토큰에 중점을 둔다. = 내가 보낸 것이 좋다.
    - RSA나 HMAC알고리즘을 사용

## [JSON 웹 토큰은 언제 사용해야 합니까?]

### (개념)

1) 권한 부여 

- JWT 사용에 대한 가장 일반적인 시나리오입니다. 
- 사용자가 로그인하면 각 후속 요청에는 JWT가 포함되므로 사용자는 해당 토큰으로 허용되는 경로, 서비스 및 리소스에 액세스 할 수 있습니다. 
- 단일 사인온은 작은 오버 헤드와 다른 도메인에서 쉽게 사용할 수있는 기능 때문에 요즘 JWT를 널리 사용하는 기능입니다.

2) 정보 교환 : 
- JSON 웹 토큰은 당사자간에 정보를 안전하게 전송하는 좋은 방법입니다. 
- JWT는 공개/개인 키 쌍을 사용하는 등 서명할 수 있으므로 보낸 사람이 자신이 말하는 사람인지 확인할 수 있습니다. 
- 또한 헤더와 페이로드를 사용하여 서명을 계산할 때 콘텐츠가 변조되지 않았는지 확인할 수도 있습니다.

## [JSON 웹 토큰 구조]
    
    - xxxxx.yyyyy.zzzzz 총 3가지
    - 머리글
    - 페이로드(정보)
    - 서명

### (3가지의 종류)

  ### (1. 머리글)

    - 알고리즘의 유형
    - 타입 ex) JWT

  {

    "alg": "HS256",

    "typ": "JWT"

  }

  그런 다음이 JSON은 JWT의 첫 번째 부분을 형성하도록 Base64Url로 인코딩됩니다.

  Base64Url: 암호화도 할 수 있고 복호화도 할 수가 있다.

    cf. 헤싱: 암호화만 되고 복호화는 할 수가 없다.

  ### (2. 페이로드)

  - 토큰의 두 번째 부분은 정보가 포함된 페이로드입니다. 
  - 클레임은 엔터티(일반적으로 사용자) 및 추가 데이터에 대한 명령문입니다. 
  - 청구에는 등록, 공개 및 비공개 청구의 세 가지 유형이 있습니다.
  
      ### (종류)

       ### (1) 등록된 클레임(=정보)) 

        - 이러한 클레임은 필수는 아니지만 권장
        - __내용__--> iss (발행자), exp (만료 시간), 하위 (주제), aud (청중) 및 기타입니다.

       ### (2) 공개 클레임): 

        - 이들은 JWT를 사용하는 사람들에 의해 마음대로 정의될 수 있다. 
        - 그러나 충돌을 방지하려면 IANA JSON 웹 토큰 레지스트리에 정의하거나 충돌 방지 네임스페이스를 포함하는 URI로 정의해야 합니다.

       ### (3) 비공개(=개인) 클레임): 

        - 주로 유저정보를 여기에 넣는다. 
        - 이러한 클레임은 사용에 동의하는 당사자 간에 정보를 공유하기 위해 만들어진 사용자 지정 클레임이며 등록 또는 공개 클레임이 아닙니다.

        예를 들어 페이로드는 다음과 같습니다.

        {

          "sub": "1234567890", (등록된 클레임)

          "name": "John Doe", (등록된 클레임)

          "admin": true (개인 클래임)

        }

        - 페이로드는 JSON 웹 토큰의 두 번째 부분을 형성하도록 Base64Url로 인코딩됩니다.
        - 서명 된 토큰의 경우이 정보는 변조로부터 보호되지만 누구나 읽을 수 있습니다. 
        - 암호화되지 않는 한 JWT의 페이로드 또는 헤더 요소에 비밀 정보를 넣지 마십시오.

  ### (3. 서명)

  - 서명 부분을 만들려면 인코딩 된 헤더, 인코딩 된 페이로드, secret(키), 헤더에 지정된 알고리즘을 가져 와서 서명해야합니다.
  - 예를 들어 HMAC SHA256 알고리즘을 사용하려는 경우 서명은 다음과 같은 방식으로 작성됩니다.

  HMACSHA256(<-- 암호화

    base64UrlEncode(header) + "." +

    base64UrlEncode(payload),

    secret)

  - 서명은 메시지가 도중에 변경되지 않았 음을 확인하는 데 사용되며, 
  - 개인 키로 서명 된 토큰의 경우 JWT의 발신자가 자신이 말하는 사람인지 확인할 수도 있습니다.

