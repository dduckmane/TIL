범위를 나눠서 그대로 구현
